(function(n){n.fn.showIndexSummary=function(t){var u=n(this),i="",r=0;n.each(t,function(){r=this.PercentChange>0?1:this.PercentChange<0?-1:0;i+="<tr class='"+(r>0?"increase":r<0?"decrease":"nochange")+"'>";i+="<td>"+this.Name+"<\/td>";i+="<td class='text-right'>"+formatNumber(this.Value,2,!1)+"<\/td>";i+="<td><span class='"+(r>0?"icon-chevron-up":r<0?"icon-chevron-down":"")+"'><\/span><\/td>";i+="<td>"+formatNumber(this.PercentChange,4,!0)+"%<\/td>";i+="<\/tr>"});u.html(i);n(u.data("live-label")).html("As of "+t[0].DateTime)};n.fn.showIndexSlider=function(t){var u=n(this),i;u.data("index-slider-nav")||(i="<li class='list-sliding-nav list-sliding-nav-left'>",i+="<button type='button' class='btn btn-default' data-nav='left'>",i+="<span class='icon-chevron-left hidden-xs'><\/span><span class='icon-chevron-up visible-xs'><\/span>",i+="<\/button>",i+="<div class='visible-xs' style='padding:2px;'><\/div>",i+="<span class='hidden-xs'>&nbsp;<\/span>",i+="<button type='button' class='btn btn-default' data-nav='right'>",i+="<span class='icon-chevron-right hidden-xs'><\/span><span class='icon-chevron-down visible-xs'><\/span>",i+="<\/button><\/li>",u.addClass("list-inline").addClass("list-sliding").append(i).attr("data-index-slider-nav",!0));var r="",f="",e="";n.each(t,function(){this.PercentChange>0?(f="text-increase",e="<span class='icon-chevron-up'><\/span>"):this.PercentChange<0?(f="text-decrease",e="<span class='icon-chevron-down'><\/span>"):(f="",e="&nbsp;&nbsp;&nbsp;");r+="<li class='list-item'>";r+="<strong>"+this.Name+"<\/strong>";r+="<span class='"+f+"'>";r+="<br/><span>"+formatNumber(this.Value,2,!1)+"<\/span> ";r+=e;r+=" <span>"+formatNumber(this.PercentChange,4,!0)+"%<\/span><\/span>";r+="<br/><span class='text-primary'>("+formatNumber(this.Turnover,2,!1)+")<\/span>";r+="<\/li>"});u.find("li:gt(0)").remove();u.append(r);n(u.data("live-label")).html("As of "+t[0].DateTime)};n.fn.showGainerLoser=function(t,i){var f=n(this),r="",s="",u=f.data("live-summary"),e,o;r+="<tr>";r+="<th>Symbol<\/th>";r+="<th>LTP<\/th>";r+="<th>% Change<\/th>";r+="<th class='"+(u?"hidden":"")+"'>High<\/th>";r+="<th class='"+(u?"hidden":"")+"'>Low<\/th>";r+="<th class='"+(u?"hidden":"")+"'>Open<\/th>";r+="<th>Qty<\/th>";r+="<th class='"+(u?"hidden":"")+"'>Turnover<\/th>";r+="<\/tr>";s=i?"increase":"decrease";e=f.data("live-range");e>0&&(t=t.slice(0,e));o="";n.each(t,function(){(i&&this.PercentChange>0||!i&&this.PercentChange<0)&&(r+="<tr class='"+s+"'>",r+="<td><a target='_blank' href='/CompanyDetail.aspx?symbol="+this.Symbol+"' title='"+this.Name+"'>"+this.Symbol+"<\/a><\/td>",r+="<td>"+formatNumber(this.LTP,2,!1)+"<\/td>",r+="<td>"+formatNumber(this.PercentChange,4,!0)+"<\/td>",r+="<td class='"+(u?"hidden":"")+"'>"+formatNumber(this.High,2,!1)+"<\/td>",r+="<td class='"+(u?"hidden":"")+"'>"+formatNumber(this.Low,2,!1)+"<\/td>",r+="<td class='"+(u?"hidden":"")+"'>"+formatNumber(this.Open,2,!1)+"<\/td>",r+="<td>"+formatNumber(this.Qty,0,!1)+"<\/td>",r+="<td class='"+(u?"hidden":"")+"'>"+formatNumber(this.Turnover,2,!1)+"<\/td>",r+="<\/tr>");o=this.DateTime});f.html(r);n(f.data("live-label")).html("As of "+o)};n.fn.showMarketSummary=function(t){var r=n(this),i="";i+="<tr><td>Total Turnover<\/td><td>"+formatNumber(t.Turnover,2,!1)+"<\/td><\/tr>";i+="<tr><td>Total Traded Shares<\/td><td>"+formatNumber(t.Quantity,0,!1)+"<\/td><\/tr>";i+="<tr><td>Total Transactions<\/td><td>"+formatNumber(t.Transactions,0,!1)+"<\/td><\/tr>";i+="<tr><td>Total Scrips Traded<\/td><td>"+formatNumber(t.Scrips,0,!1)+"<\/td><\/tr>";i+="<tr><td>Total Market Capitalization<\/td><td>"+t.MarketCap+"<\/td><\/tr>";i+="<tr><td>Floated Market Capitalization<\/td><td>"+t.FloatedCap+"<\/td><\/tr>";r.html(i);n(r.data("live-label")).html("As of "+t.Date)};n.fn.showTurnovers=function(t,i){var f=n(this),r="",u=f.data("live-summary"),e;r+="<tr>";r+="<th>Symbol<\/th>";r+="<th>Turnover<\/th>";r+="<th>LTP<\/th>";r+="<th class='"+(u?"hidden":"")+"'>% Change<\/th>";r+="<th class='"+(u?"hidden":"")+"'>High<\/th>";r+="<th class='"+(u?"hidden":"")+"'>Low<\/th>";r+="<th class='"+(u?"hidden":"")+"'>Open<\/th>";r+="<th class='"+(u?"hidden":"")+"'>Qty<\/th>";r+="<\/tr>";e=f.data("live-range");e>0&&(t=t.slice(0,e));n.each(t,function(){r+="<tr>";r+="<td><a target='_blank' href='/CompanyDetail.aspx?symbol="+this.Symbol+"' title='"+this.Name+"'>"+this.Symbol+"<\/a><\/td>";r+="<td>"+formatNumber(this.Turnover,2,!1)+"<\/td>";r+="<td>"+formatNumber(this.LTP,2,!1)+"<\/td>";r+="<td class='"+(u?"hidden":"")+"'>"+formatNumber(this.PercentChange,4,!0)+"<\/td>";r+="<td class='"+(u?"hidden":"")+"'>"+formatNumber(this.High,2,!1)+"<\/td>";r+="<td class='"+(u?"hidden":"")+"'>"+formatNumber(this.Low,2,!1)+"<\/td>";r+="<td class='"+(u?"hidden":"")+"'>"+formatNumber(this.Open,2,!1)+"<\/td>";r+="<td class='"+(u?"hidden":"")+"'>"+formatNumber(this.Qty,0,!1)+"<\/td>";r+="<\/tr>"});f.html(r);n(f.data("live-label")).html("As of "+i)};n.fn.showSectors=function(t,i){var u=n(this),r="",e=u.data("live-summary"),f;r+="<tr>";r+="<th>Sector<\/th>";r+="<th>Turnover<\/th>";r+="<th class='"+(e?"hidden":"")+"'>Qty<\/th>";r+="<\/tr>";f=u.data("live-range");f>0&&(t=t.slice(0,f));n.each(t,function(){r+="<tr>";r+="<td>"+this.Sector+"<\/td>";r+="<td>"+formatNumber(this.Turnover,2,!1)+"<\/td>";r+="<td class='"+(e?"hidden":"")+"'>"+formatNumber(this.Qty,0,!1)+"<\/td>";r+="<\/tr>"});u.html(r);n(u.data("live-label")).html("As of "+i)};n.fn.showBrokers=function(t,i){var f=n(this),r="",u=f.data("live-summary"),e;r+="<tr>";r+="<th>Broker<\/th>";r+="<th class='"+(u?"hidden":"")+"'>Purchase<\/th>";r+="<th class='"+(u?"hidden":"")+"'>Sales<\/th>";r+="<th class='"+(u?"hidden":"")+"'>Matching<\/th>";r+="<th>"+(u?"Amount":"Total")+"<\/th>";r+="<th><\/th>";r+="<\/tr>";e=f.data("live-range");e>0&&(t=t.slice(0,e));n.each(t,function(){r+="<tr>";r+="<td><a target='_blank' href='/BrokerDetail.aspx?code="+this.BrokerCode+"' title='"+this.BrokerName+"'>"+this.BrokerCode+"<\/a><\/td>";r+="<td class='"+(u?"hidden":"")+"'>"+formatNumber(this.Purchase,2,!1)+"<\/td>";r+="<td class='"+(u?"hidden":"")+"'>"+formatNumber(this.Sales,2,!1)+"<\/td>";r+="<td class='"+(u?"hidden":"")+"'>"+formatNumber(this.Matching,2,!1)+"<\/td>";r+="<td>"+formatNumber(this.Total,2,!1)+"<\/td>";r+="<td><a target='_blank' href='/BrokerFloorsheet.aspx?code="+this.BrokerCode+"' title='View Floorsheet'>View<\/a><\/td>";r+="<\/tr>"});f.html(r);n(f.data("live-label")).html("As of "+i)};n.fn.showLiveTrading=function(t){var u=n(this),i="",r="";i+="<tr>";i+="<th>Symbol<\/th>";i+="<th>LTP<\/th>";i+="<th>LTV<\/th>";i+="<th nowrap>% Change<\/th>";i+="<th>High<\/th>";i+="<th>Low<\/th>";i+="<th>Open<\/th>";i+="<th>Qty.<\/th>";i+="<th><\/th>";i+="<th><\/th>";i+="<\/tr>";n.each(t,function(){r=this.PercentChange>0?"increase-row":this.PercentChange<0?"decrease-row":"nochange-row";i+="<tr class='"+r+"'>";i+="<td><a target='_blank' href='/CompanyDetail.aspx?symbol="+this.Symbol+"' title='"+this.Name+"'>"+this.Symbol+"<\/a><\/td>";i+="<td>"+formatNumber(this.LTP,2,!1)+"<\/td>";i+="<td>"+formatNumber(this.LTV,0,!1)+"<\/td>";i+="<td>"+formatNumber(this.PercentChange,4,!0)+"<\/td>";i+="<td>"+formatNumber(this.High,2,!1)+"<\/td>";i+="<td>"+formatNumber(this.Low,2,!1)+"<\/td>";i+="<td>"+formatNumber(this.Open,2,!1)+"<\/td>";i+="<td>"+formatNumber(this.Qty,0,!1)+"<\/td>";i+="<td><a href='javascript:void(0);' title='Add to Watchlist' onclick='addToWatchlist(\""+this.Symbol+"\");'><i class='icon-tags icon-white'><\/i><\/a><\/td>";i+="<td><a href='javascript:void(0);' title='Set as Alert' onclick='setAlert(\""+this.Symbol+"\");'><i class='icon-bell icon-white'><\/i><\/a><\/td>";i+="<\/tr>"});u.html(i);n(u.data("live-label")).html("As of "+t[0].DateTime)}})(jQuery);var StockTicker={sortObject:function(n){var t=[];return $.each(n,function(){t[this.Order]=this}),t},sortGainer:function(n){var t=n.slice();return t.sort(function(n,t){return parseFloat(n.PercentChange)<parseFloat(t.PercentChange)?1:parseFloat(n.PercentChange)>parseFloat(t.PercentChange)?-1:0}),t},remapIndexData:function(n){return remapDictionaryArray(n,{n:"Name",v:"Value",pc:"PercentChange",t:"Turnover",si:"IsSubIndex",d:"DateTime",o:"Order"})},remapStockData:function(n){return AutoSuggest.symbolJson!={}&&$.each(n,function(){this.n=AutoSuggest.symbolJson[this.s]}),remapDictionaryArray(n,{s:"Symbol",n:"Name",lp:"LTP",c:"PriceChange",pc:"PercentChange",h:"High",l:"Low",op:"Open",q:"Qty",lv:"LTV",t:"Turnover",d:"DateTime",o:"Order"})},remapMarketSummary:function(n){return remapObject(n,{d:"Date",t:"Turnover",q:"Quantity",tn:"Transactions",st:"Scrips",mc:"MarketCap",fc:"FloatedCap"})},remapTurnover:function(n){return AutoSuggest.symbolJson!={}&&$.each(n,function(){this.n=AutoSuggest.symbolJson[this.s]}),remapArray(n,{s:"Symbol",n:"Name",t:"Turnover",lp:"LTP",pc:"PercentChange",h:"High",l:"Low",op:"Open",q:"Qty"})},remapSector:function(n){return remapArray(n,{s:"Sector",t:"Turnover",q:"Qty"})},remapBroker:function(n){return remapArray(n,{b:"BrokerCode",n:"BrokerName",p:"Purchase",s:"Sales",m:"Matching",t:"Total"})},showData:function(n){var i,f=[],t=[],r=[],u=[],e;$("[data-live='index-summary']").each(function(){i=$(this);f.length==0&&(f=StockTicker.sortObject(StockTicker.remapIndexData(n.Indices)));i.showIndexSummary(f)});$("[data-live='index-slider']").each(function(){i=$(this);f.length==0&&(f=StockTicker.sortObject(StockTicker.remapIndexData(n.Indices)));i.showIndexSlider(f)});$("[data-live='gainers']").each(function(){i=$(this);t.length==0&&(t=StockTicker.remapStockData(n.Stocks));r.length==0&&(r=StockTicker.sortObject(t));u.length==0&&(u=StockTicker.sortGainer(r));i.showGainerLoser(u,!0)});e=!1;$("[data-live='losers']").each(function(){i=$(this);t.length==0&&(t=StockTicker.remapStockData(n.Stocks));r.length==0&&(r=StockTicker.sortObject(t));u.length==0&&(u=StockTicker.sortGainer(r));e==!1&&(u.reverse(),e=!0);i.showGainerLoser(u,!1)});$("[data-live='live-trading']").each(function(){i=$(this);t.length==0&&(t=StockTicker.remapStockData(n.Stocks));r.length==0&&(r=StockTicker.sortObject(t));i.showLiveTrading(r)});$("[data-live='user-watchlist']").each(function(){i=$(this);t.length==0&&(t=StockTicker.remapStockData(n.Stocks));MyWatchlist.updateWatchlist(t)});$("[data-live='temp-watchlist']").each(function(){i=$(this);t.length==0&&(t=StockTicker.remapStockData(n.Stocks));TempWatchlist.updateWatchlist(t)});$("[data-live='user-portfolio']").each(function(){i=$(this);t.length==0&&(t=StockTicker.remapStockData(n.Stocks));MyPortfolio.bindPortfolio(t)})},showMarketSummary:function(n){var i,t=[];$("[data-live='market-summary']").each(function(){i=$(this);t.length==0&&(t=StockTicker.remapMarketSummary(n));i.showMarketSummary(t)})},showTurnovers:function(n){var i,t=[];$("[data-live='turnovers']").each(function(){i=$(this);t.length==0&&(t=StockTicker.remapTurnover(n.detail));i.showTurnovers(t,n.date,!0)})},showSectors:function(n){var i,t=[];$("[data-live='sectors']").each(function(){i=$(this);t.length==0&&(t=StockTicker.remapSector(n.detail));i.showSectors(t,n.date,!0)})},showBrokers:function(n){var i,t=[];$("[data-live='brokers']").each(function(){i=$(this);t.length==0&&(t=StockTicker.remapBroker(n.detail));i.showBrokers(t,n.date)})}};$(document).ready(function(){function t(){n.server.getAllStocks().done(function(n){console.log("first data");StockTicker.showData(n)})}var n=$.connection.stockTickerHub,i=$("#tblStocks"),r=$("#tblIndices"),u=$("#tblLatestTrades");n.client.updateStockPrice=function(n){console.log("broadcast data");StockTicker.showData(n)};$.connection.hub.start().done(t);$("[data-live='market-summary'], [data-live='turnovers'], [data-live='sectors'], [data-live='brokers']").length>0&&(console.log("market summary"),$.ajax({url:"/handlers/webrequesthandler.ashx?type=market_summary",type:"GET",dataType:"json",success:function(n){n!=""&&n.mt=="ok"&&(StockTicker.showMarketSummary(n.overall),StockTicker.showTurnovers(n.turnover),StockTicker.showSectors(n.sector),StockTicker.showBrokers(n.broker))},error:function(n,t,i){console.log(i)}}))})